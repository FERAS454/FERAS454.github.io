<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="This post shows how to detect malicious URLs using a neural network with Keras, covering feature extraction, training, and evaluation."><title>Machine Learning Detection of Malicious URLs with Implementation Using Keras</title>
<link rel=canonical href=https://feras454.github.io/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Machine Learning Detection of Malicious URLs with Implementation Using Keras"><meta property='og:description' content="This post shows how to detect malicious URLs using a neural network with Keras, covering feature extraction, training, and evaluation."><meta property='og:url' content='https://feras454.github.io/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/'><meta property='og:site_name' content='Feras Jalalah'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Machine learning'><meta property='article:tag' content='Threat Detection'><meta property='article:tag' content='Malicious URLs'><meta property='article:published_time' content='2022-11-07T00:00:00+00:00'><meta property='article:modified_time' content='2022-11-07T00:00:00+00:00'><meta property='og:image' content='https://feras454.github.io/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/banner.png'><meta name=twitter:title content="Machine Learning Detection of Malicious URLs with Implementation Using Keras"><meta name=twitter:description content="This post shows how to detect malicious URLs using a neural network with Keras, covering feature extraction, training, and evaluation."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://feras454.github.io/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/banner.png'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu12637548636728576105.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Feras Jalalah</a></h1><h2 class=site-description>Interested in DFIR, SOC, Threat Hunting, and Threat Intel.</h2></div></header><ol class=menu-social><li><a href=https://twitter.com/Feras_454 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>About</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#introduction>Introduction</a></li><li><a href=#dataset>Dataset</a></li><li><a href=#step-by-step-code-breakdown>Step-by-Step Code Breakdown</a><ol><li><a href=#step-1-importing-necessary-libraries>Step 1: Importing Necessary Libraries</a></li><li><a href=#step-2-loading-the-dataset>Step 2: Loading the Dataset</a></li><li><a href=#step-3-feature-engineering>Step 3: Feature Engineering</a></li><li><a href=#step-4-label-encoding>Step 4: Label Encoding</a></li><li><a href=#step-5-data-splitting>Step 5: Data Splitting</a></li><li><a href=#step-6-neural-network-model>Step 6: Neural Network Model</a></li><li><a href=#step-7-compiling-and-training-the-model>Step 7: Compiling and Training the Model</a></li><li><a href=#step-8-model-evaluation>Step 8: Model Evaluation</a></li><li><a href=#step-9-visualizing-accuracy-and-loss>Step 9: Visualizing Accuracy and Loss</a></li></ol></li><li><a href=#conclusion>Conclusion</a><ol><li><a href=#references>References</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/><img src=/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/banner_hu9513615269667656926.png srcset="/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/banner_hu9513615269667656926.png 800w, /p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/banner_hu12986327081130104642.png 1600w" width=800 height=391 loading=lazy alt="Featured image of post Machine Learning Detection of Malicious URLs with Implementation Using Keras"></a></div><div class=article-details><header class=article-category><a href=/categories/cybersecurity-projects/>Cybersecurity Projects</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/>Machine Learning Detection of Malicious URLs with Implementation Using Keras</a></h2><h3 class=article-subtitle>This post shows how to detect malicious URLs using a neural network with Keras, covering feature extraction, training, and evaluation.</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Nov 07, 2022</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>4 minute read</time></div></footer></div></header><section class=article-content><h2 id=introduction>Introduction</h2><p>This project is part of the <strong>Machine Learning for Cybersecurity course</strong> I am taking as a cybersecurity student at the university. While I am not an ML engineer, this blog outlines how to implement a deep learning model to detect malicious URLs. I will demonstrate how a neural network can classify URLs as benign or malicious using specific features. Basic ML knowledge is required, but deep expertise is not necessary.</p><hr><h2 id=dataset>Dataset</h2><p>The dataset used is the <strong>Malicious URLs Phishing Dataset</strong>, which contains benign and malicious URLs. The dataset and full project code are available on <a class=link href=https://github.com/Feras454/Detection-of-Malicious-URLs-using-machine-learning target=_blank rel=noopener>GitHub</a>.</p><hr><h2 id=step-by-step-code-breakdown>Step-by-Step Code Breakdown</h2><h3 id=step-1-importing-necessary-libraries>Step 1: Importing Necessary Libraries</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>matplotlib</span> <span class=kn>import</span> <span class=n>pyplot</span> <span class=k>as</span> <span class=n>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>urllib.parse</span> <span class=kn>import</span> <span class=n>urlparse</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>keras.models</span> <span class=kn>import</span> <span class=n>Sequential</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>keras.layers</span> <span class=kn>import</span> <span class=n>Dense</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.model_selection</span> <span class=kn>import</span> <span class=n>train_test_split</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.preprocessing</span> <span class=kn>import</span> <span class=n>LabelEncoder</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.metrics</span> <span class=kn>import</span> <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>classification_report</span><span class=p>,</span> <span class=n>confusion_matrix</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=step-2-loading-the-dataset>Step 2: Loading the Dataset</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># You can find the dataset on my github repo</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;malicious_phish.csv&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>type</span><span class=o>.</span><span class=n>value_counts</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><hr><p><img src=/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/DATA.png width=437 height=276 srcset="/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/DATA_hu16222022505552597520.png 480w, /p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/DATA_hu10220018759302966314.png 1024w" loading=lazy alt="URL samples and types" class=gallery-image data-flex-grow=158 data-flex-basis=380px></p><h3 id=step-3-feature-engineering>Step 3: Feature Engineering</h3><p>Custom functions extract features like the presence of an IP address, URL length, and count of sensitive words. The features and their descriptions are listed below:</p><div class=table-wrapper><table><thead><tr><th><strong>Feature</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><code>use_of_ip</code></td><td>Whether the URL contains an IP address.</td></tr><tr><td><code>url_length</code></td><td>The total length of the URL.</td></tr><tr><td><code>numOf-https</code></td><td>Count of &lsquo;https&rsquo; occurrences in the URL.</td></tr><tr><td><code>numOf-http</code></td><td>Count of &lsquo;http&rsquo; occurrences in the URL.</td></tr><tr><td><code>hostname_length</code></td><td>Length of the hostname part of the URL.</td></tr><tr><td><code>count-digits</code></td><td>Number of digits in the URL.</td></tr><tr><td><code>count-letters</code></td><td>Number of alphabetic characters in the URL.</td></tr><tr><td><code>NumSensitiveWords</code></td><td>Whether the URL contains sensitive words like &lsquo;PayPal,&rsquo; &rsquo;login,&rsquo; or &lsquo;bank.&rsquo;</td></tr><tr><td><code>numOf.</code></td><td>Count of periods (&rsquo;.&rsquo;) in the URL.</td></tr><tr><td><code>numOf%</code></td><td>Count of &lsquo;%&rsquo; in the URL.</td></tr><tr><td><code>numOf?</code></td><td>Count of &lsquo;?&rsquo; in the URL.</td></tr><tr><td><code>numOf-</code></td><td>Count of dashes (&rsquo;-&rsquo;) in the URL.</td></tr><tr><td><code>numOf=</code></td><td>Count of equal signs (&rsquo;=&rsquo;) in the URL.</td></tr><tr><td><code>abnormal_url</code></td><td>Whether the URL contains abnormal structures.</td></tr><tr><td><code>binary</code></td><td>Binary representation of the URL&rsquo;s classification (<code>0</code> for benign, <code>1</code> for malicious).</td></tr></tbody></table></div><p>Each of these features was chosen because they are commonly found in malicious URLs, such as the presence of IP addresses, which are often used to evade detection, and sensitive keywords like &rsquo;login&rsquo; or &lsquo;bank,&rsquo; which are frequently used in phishing URLs.</p><hr><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>having_ip_address</span><span class=p>(</span><span class=n>url</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>,</span> <span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1</span> <span class=k>if</span> <span class=k>match</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=p>[</span><span class=s1>&#39;use_of_ip&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;url&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>having_ip_address</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=p>[</span><span class=s1>&#39;url_length&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;url&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>i</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=p>[</span><span class=s1>&#39;numOf-https&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;url&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>i</span><span class=p>:</span> <span class=n>i</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s1>&#39;https&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># Additional features are also extracted...</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=step-4-label-encoding>Step 4: Label Encoding</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>lb_make</span> <span class=o>=</span> <span class=n>LabelEncoder</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=p>[</span><span class=s1>&#39;class&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>lb_make</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;class&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>In this project, <strong>label encoding</strong> is applied to the <code>type</code> column, which contains the categorical URL types (e.g., &ldquo;benign&rdquo;, &ldquo;phishing&rdquo;, &ldquo;malware&rdquo;), to convert them into numerical values that the model can process. The <strong>LabelEncoder</strong> from <code>sklearn.preprocessing</code> is used to transform the text labels into integers.</p><p><img src=/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/lable.png width=1087 height=359 srcset="/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/lable_hu13367705369311776112.png 480w, /p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/lable_hu9290045266474620335.png 1024w" loading=lazy alt="Lable encoding" class=gallery-image data-flex-grow=302 data-flex-basis=726px></p><h3 id=step-5-data-splitting>Step 5: Data Splitting</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>X</span> <span class=o>=</span> <span class=n>data</span><span class=p>[[</span><span class=s1>&#39;use_of_ip&#39;</span><span class=p>,</span> <span class=s1>&#39;url_length&#39;</span><span class=p>,</span> <span class=s1>&#39;NumSensitiveWords&#39;</span><span class=p>,</span> <span class=s1>&#39;numOf-https&#39;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;class&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=step-6-neural-network-model>Step 6: Neural Network Model</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>Sequential</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Dense</span><span class=p>(</span><span class=mi>128</span><span class=p>,</span> <span class=n>input_shape</span><span class=o>=</span><span class=p>(</span><span class=n>X_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],),</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Dense</span><span class=p>(</span><span class=mi>64</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Dense</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;softmax&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>The model uses two dense layers with ReLU activation to capture non-linear patterns, and the final layer uses softmax for multi-class classification</p><p>![[Head.png]]</p><h3 id=step-7-compiling-and-training-the-model>Step 7: Compiling and Training the Model</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>optimizer</span><span class=o>=</span><span class=s1>&#39;adam&#39;</span><span class=p>,</span> <span class=n>loss</span><span class=o>=</span><span class=s1>&#39;categorical_crossentropy&#39;</span><span class=p>,</span> <span class=n>metrics</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;categorical_accuracy&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>history</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>validation_data</span><span class=o>=</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=step-8-model-evaluation>Step 8: Model Evaluation</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>loss</span><span class=p>,</span> <span class=n>accuracy</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Test accuracy: </span><span class=si>{</span><span class=n>accuracy</span><span class=si>:</span><span class=s1>.3</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>The accuracy curve shows steady learning over the epochs, and the low loss indicates that the model is fitting the data well without overfitting</p><p>![[Pasted image 20241026151743.png]]</p><h3 id=step-9-visualizing-accuracy-and-loss>Step 9: Visualizing Accuracy and Loss</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>history</span><span class=o>.</span><span class=n>history</span><span class=p>[</span><span class=s1>&#39;categorical_accuracy&#39;</span><span class=p>],</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Training Accuracy&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>history</span><span class=o>.</span><span class=n>history</span><span class=p>[</span><span class=s1>&#39;val_categorical_accuracy&#39;</span><span class=p>],</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Validation Accuracy&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Model Accuracy&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/acc.png width=1232 height=960 srcset="/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/acc_hu13384165379978922459.png 480w, /p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/acc_hu11001634722734879518.png 1024w" loading=lazy alt="The Accuracy" class=gallery-image data-flex-grow=128 data-flex-basis=308px><img src=/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/loss.png width=1254 height=940 srcset="/p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/loss_hu14630334402095247703.png 480w, /p/machine-learning-detection-of-malicious-urls-with-implementation-using-keras/loss_hu5456687679972750038.png 1024w" loading=lazy alt="The Loss" class=gallery-image data-flex-grow=133 data-flex-basis=320px></p><hr><h2 id=conclusion>Conclusion</h2><p>This project demonstrates the application of machine learning in detecting malicious URLs. The full code and dataset can be accessed on <a class=link href=https://github.com/Feras454/Detection-of-Malicious-URLs-using-machine-learning target=_blank rel=noopener>GitHub</a>.</p><h3 id=references>References</h3><ul><li><strong>Ma, J., Saul, L. K., Savage, S., and Voelker, G. M. (2009).</strong> <em>Beyond Blacklists: Learning to Detect Malicious Web Sites from Suspicious URLs</em>. Proceedings of the 15th ACM SIGKDD Conference on Knowledge Discovery and Data Mining.</li><li><strong>Verma, R. and Hossain, N. (2017).</strong> <em>Phish-Zoo: Detecting Phishing Websites By Looking At Them</em>. IEEE Transactions on Dependable and Secure Computing.</li><li><strong>Basnet, R., Mukkamala, S., and Sung, A. H. (2008).</strong> <em>Detection of Phishing Attacks: A Machine Learning Approach</em>. Studies in Fuzziness and Soft Computing.</li><li><strong>Buczak, A. L., and Guven, E. (2016).</strong> <em>A Survey of Data Mining and Machine Learning Methods for Cybersecurity Intrusion Detection</em>. IEEE Communications Surveys & Tutorials.</li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/machine-learning/>Machine Learning</a>
<a href=/tags/threat-detection/>Threat Detection</a>
<a href=/tags/malicious-urls/>Malicious URLs</a></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Nov 07, 2022 00:00 UTC</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2024 Feras Jalalah</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.29.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>